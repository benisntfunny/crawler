{
    "id": "7efd274a63dc01be4a969a30aa11dbc9fbb4b93becda82c660ae208239cec2bf-part2",
    "url": "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_guest_security_deploy.htm&language=en_US&type=5",
    "content": "nullSalesforce B2B Commerce for Visualforce\nTABLE OF CONTENTS\nClose\nClose\nSearch\nSearch\n Salesforce B2B Commerce for Visualforce\n Get Started with B2B Commerce for Visualforce\n Install B2B Commerce for Visualforce\n Set Up a Storefront\n Create Storefront Information in CC Admin\n Create an Experience Cloud Site for the Storefront\n Configure Public Pages for a Storefront\n Configure the Storefront Secure Domain\n Assign Permissions for Storefront Guest Users\n Assign Permissions for Storefront Registered Users\n Assign Visualforce Pages for User Self-Registration\n Create a Default Owner for Records Created by a Storefront Guest User\n Configure External Sharing Settings for Storefront Users\n Create Sharing Rules for Guest User Access to Storefront Objects\n Deploy Storefront Sharing Rules Metadata Programmatically\n Storefront Guest User Sharing Rules Metadata Examples\n Add Account Group to the Standard Account Layout\n Finalize and Publish Your Storefront\n Find Information About Your B2B Commerce Package Installation\n Manage Storefront Details and Metadata\n Set Up Product Data for B2B Commerce for Visualforce\n Help Buyers Discover Products on Your Storefront\n Price and Sell Products for B2B Commerce for Visualforce\n Support Buyer Accounts for B2B Commerce for Visualforce\n Provide a Smooth Path to Purchase for Storefront Buyers\n Customize the Storefront User Experience\n Strategize for Storefront Success\n Deliver Storefront Performance and Security\n Market Templates for B2B Commerce for Visualforce\n Solution Resources for B2B Commerce for Visualforce\n\nYou are here:\n\nSALESFORCE HELP\nDOCS\nVISUALFORCE B2B COMMERCE\nDeploy Storefront Sharing Rules Metadata Programmatically\n\nIf you manage multiple storefronts and Experience Cloud sites, creating sharing rules for every affected B2B Commerce custom object across every site can be a time-consuming task. To more efficiently deploy sharing rules to all of your sites, you can programmatically deploy sharing rules metadata through a command-line tool.\n\nREQUIRED EDITIONS\n\nSalesforce Compatibility\n\nSalesforce Classic (not available in all orgs) and Lightning Experience for Enterprise, Performance, Unlimited, and Developer editions.\n\n\n\n\nB2B Commerce Compatibility\n\nB2B Commerce for Visualforce Winter ’21 (version 4.13) release build 3.149 or later\nB2B Commerce for Visualforce Spring ’20 (version 4.12) release build 3.147 or later\nB2B Commerce for Visualforce Summer ’19 (version 4.11) patch 3.145.9 or later\nB2B Commerce for Visualforce Spring ’19 (version 4.10) patch 3.142.20 or later\nB2B Commerce for Visualforce Summer ’18 (version 4.9) patch 3.136.36 or later\nCloudCraze 4.8 patch 3.133.24 or later\nCloudCraze 4.7 patch 3.124.36 or later\nNOTE Deploying sharing rules metadata using the sharingGuestRules field requires API version 47.0 or later.\nCreate a local, project-level folder, such as project.\nIn the project folder, create a folder to contain sharing rule metadata XML files. Name the folder sharingRules.\nIn the sharingRules folder, create a metadata XML file for each object's sharing rule. Name the file namespace__objectAPIName.sharingRules, such as ccrz__E_AccountGroup__c.sharingRules.\nWARNING Remember, create only the sharing rules necessary to keep your storefront functional and secure. You want a guest user to access all the objects that they need, but none of the objects that they don't need.\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<SharingRules xmlns=\"http://soap.sforce.com/2006/04/metadata\">\n    <sharingGuestRules>\n        <fullName>sharingRuleName</fullName>\n        <accessLevel>Read</accessLevel>\n        <label>sharingRuleLabel</label>\n        <sharedTo>\n            <guestUser>guestUserNickname</guestUser>\n        </sharedTo>\n        <criteriaItems>\n            <field>fieldName</field>\n            <operation>operator</operation>\n            <value>criteriaValue</value>\n        </criteriaItems>\n    </sharingGuestRules>\n</SharingRules>\n\nIn this file, specify the following details:\n\nsharingRuleName\nThe unique rule name.\nsharingRuleLabel\nThe unique rule label.\nguestUserNickname\nThe nickname for the site guest user, such as B2B_Customer_Site_Guest.\nfieldName\nThe name—not the label—of the object's field that the sharing rule criteria is based on. For example, in the CC Account Group sharing rule, the label Account Group Name corresponds to the field Name. When you create a sharing rule manually from Sharing Settings, you select a field label. When you create a metadata XML file, you specify the field name.\noperator\nThe operator for the criteria, such as equals or not equal to.\ncriteriaValue\nThe value for the criteria, such as the storefront name or the B2B_Commerce_Guest_Restricted string.\n\nFor example, the metadata XML file for the CC Account Group sharing rule can look like:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<SharingRules xmlns=\"http://soap.sforce.com/2006/04/metadata\">\n    <sharingGuestRules>\n        <fullName>CC_Account_Group_Guest_Access</fullName>\n        <accessLevel>Read</accessLevel>\n        <label>CC Account Group Guest Access</label>\n        <sharedTo>\n            <guestUser>B2B_Customer_Site_Guest</guestUser>\n        </sharedTo>\n        <criteriaItems>\n            <field>Name</field>\n            <operation>notEqual</operation>\n            <value>B2B_Commerce_Guest_Restricted</value>\n        </criteriaItems>\n    </sharingGuestRules>\n</SharingRules>\nCreate the other sharing rules metadata XML files that your storefront requires. For more examples, see Storefront Guest User Sharing Rules Metadata Examples.\nBack in the project folder, create a package.xml file that lists all the individual sharing rules by their objectAPIName and sharingRuleName.\n<Package xmlns=\"http://soap.sforce.com/2006/04/metadata\">\n    <types>\n        <members>objectAPIName.sharingRuleName</members>\n        <name>SharingGuestRule</name>\n    </types>\n    <types>\n        <members>objectAPIName.sharingRuleName<</members>\n        <name>SharingGuestRule</name>\n    </types>\n    ...\n    <version>47.0</version>\n</Package>\n\nFor example, a package.xml file that references sharing rules for the standard account object and the CC Account Group custom object can look like:\n\n<Package xmlns=\"http://soap.sforce.com/2006/04/metadata\">\n    <types>\n        <members>Account.Account_Guest_Access</members>\n        <name>SharingGuestRule</name>\n    </types>\n    <types>\n        <members>ccrz__E_AccountGroup__c.CC_Account_Group_Guest_Access</members>\n        <name>SharingGuestRule</name>\n    </types>\n    <types>\n        <members>ccrz__E_AccountGroupPriceList__c.CC_Account_Group_Price_List_Guest_Access</members>\n        <name>SharingGuestRule</name>\n    </types>\n    ...\n    <version>47.0</version>\n</Package>\n\nYour completed project folder has the following structure:\n\nDeploy the metadata XML files and package.xml with one of the following tools:\nSalesforce CLI, using the mdapi:deploy command.\nAnt Migration Tool\nSEE ALSO\nAllow a B2B Commerce for Visualforce Guest Buyer to Browse Your Storefront\n(Salesforce Developers): SharingRules\nStorefront Guest User Sharing Rules Metadata Examples\nDID THIS ARTICLE SOLVE YOUR ISSUE?\nLet us know so we can improve!\nYes\nNo\n ",
    "title": "Programmatic Deployment of B2B Commerce Sharing Rules",
    "keywords": [
        "B2B Commerce",
        "Salesforce CLI",
        "Ant Migration Tool",
        "SharingRules",
        "guest user access"
    ],
    "links": [
        "https://help.salesforce.com/sfsites/c/resource/HTCommunityCustomJS/HC_TbidAuth.js",
        "https://help.salesforce.com/s/support\",\"target\":\"_self\",\"label\":\"Contact",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_visualforce.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_start.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_install.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_setup.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_setup_community_users.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_setup_self_register.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_setup_sharing_rules.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_admin.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_admin_global.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_storefront_data.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_settings_loader.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_admin_storefront.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_configuration.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_configuration_settings.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_product.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_product_types.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_product_dynamic_kit.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_product_image.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_discovery.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_category.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_category_media.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_spec.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_product_index.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_sell.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_price_list.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_promotion.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_coupon.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_buyer.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_account_group.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_effective_account.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_purchase.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_cart_scale.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_storefront_ux.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_pages.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_home.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_checkout.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_my_account.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_product_compare.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_product_detail.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_product_list.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_scaled_cart.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_shopping_cart.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_site_login.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_site_register.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_components.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_components_effective_account_selector.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_components_feature_filtering.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_components_spotlight_featured_products.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_labels.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_menu.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_theme.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_extension.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_storefront.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_localize.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_seo.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_seo_friendly_urls.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_seo_bot_pages.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_lwc.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_trust.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_shield.htm&language=en_US&type=5",
        "https://help.salesforce.com/s?language=en_US",
        "https://help.salesforce.com/s/articleView?id=sf.overview_edition_lex_only.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_setup_sharing_rules_metadata.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_guest.htm&language=en_US&type=5"
    ],
    "embedding": [
        -0.5455344915390015,
        0.609209418296814,
        0.030146829783916473,
        0.09717901796102524,
        0.5013853311538696,
        0.9121168255805969,
        0.0869443416595459,
        0.2964499890804291,
        -0.08408196270465851,
        0.19999057054519653,
        0.274149090051651,
        -0.3158970773220062,
        -0.39702191948890686,
        -0.18376852571964264,
        0.19162651896476746,
        -0.7696028351783752,
        -0.1762199103832245,
        -0.605076253414154,
        0.49104711413383484,
        -0.9066875576972961,
        0.20573490858078003,
        0.01602759212255478,
        -0.543402910232544,
        -0.3137158155441284,
        -0.5014038681983948,
        -0.07029961049556732,
        -1.2931972742080688,
        0.2500178813934326,
        0.5058755874633789,
        -0.6033840775489807,
        -0.21744264662265778,
        0.03328056260943413,
        0.581255316734314,
        0.3056284487247467,
        -0.21122261881828308,
        0.3263678550720215,
        -0.100950226187706,
        0.09324964880943298,
        0.6860450506210327,
        -0.47384732961654663,
        -0.07294130325317383,
        -0.14963918924331665,
        -0.6948123574256897,
        0.17537766695022583,
        -0.44734764099121094,
        -0.1663612723350525,
        -0.34175559878349304,
        -0.18970051407814026,
        -0.26655107736587524,
        0.32592296600341797,
        0.631369948387146,
        0.4385644197463989,
        -0.41925355792045593,
        0.10889473557472229,
        0.45129159092903137,
        -0.8722422122955322,
        0.5565279722213745,
        0.7650598883628845,
        -0.1956186592578888,
        0.012775994837284088,
        -1.031358003616333,
        0.16438087821006775,
        -0.6052471399307251,
        -0.34180203080177307,
        -0.5638140439987183,
        0.046854082494974136,
        0.2704852223396301,
        -0.6355095505714417,
        -0.8640031814575195,
        -0.4895429015159607,
        -0.1513650268316269,
        -0.4729471206665039,
        -0.3817269504070282,
        -0.296987384557724,
        0.43606358766555786,
        -0.39696991443634033,
        0.5030461549758911,
        0.3026200234889984,
        -0.3840102255344391,
        -0.2168554663658142,
        0.5882108807563782,
        1.130362629890442,
        0.033268705010414124,
        0.638438880443573,
        0.35963836312294006,
        0.2759438455104828,
        0.13306087255477905,
        -0.03464808315038681,
        -0.1654694527387619,
        -0.10298416018486023,
        -0.28997889161109924,
        -0.2515067756175995,
        -0.5190885663032532,
        -0.13785581290721893,
        -0.62906813621521,
        0.02220214158296585,
        1.051500916481018,
        -0.10197076201438904,
        -0.3841041922569275,
        0.13721086084842682,
        -0.16149728000164032,
        -0.9081833958625793,
        -0.6661473512649536,
        -1.312017560005188,
        -0.3684994578361511,
        0.15748706459999084,
        -0.3332071602344513,
        0.7681350708007812,
        -0.4355463981628418,
        4.181351184844971,
        0.3325670659542084,
        0.32959821820259094,
        0.5811970233917236,
        0.06241343542933464,
        0.6502216458320618,
        -0.03239335119724274,
        -0.35695770382881165,
        -0.0003599608317017555,
        -1.3339660167694092,
        0.4507370591163635,
        0.1648598462343216,
        -0.004910934716463089,
        0.6355162858963013,
        -0.5329257249832153,
        0.6445699334144592,
        -0.22454749047756195,
        0.4387510418891907,
        0.287465363740921,
        -0.6226818561553955,
        -0.9620130062103271,
        -0.158873051404953,
        0.037722524255514145,
        1.007260799407959,
        0.3281199634075165,
        0.07666069269180298,
        -0.06481804698705673,
        -0.1880682110786438,
        0.22473815083503723,
        -0.34030765295028687,
        0.1583249866962433,
        -0.41884350776672363,
        0.714534342288971,
        -0.4962335526943207,
        0.08487953245639801,
        0.31703826785087585,
        0.39189162850379944,
        0.2104758769273758,
        0.606630802154541,
        -0.46319708228111267,
        0.07734645903110504,
        0.8437226414680481,
        -0.08037818223237991,
        -0.24824732542037964,
        0.011851303279399872,
        0.13871893286705017,
        0.3239632546901703,
        -0.30129528045654297,
        0.7355474233627319,
        0.06728702783584595,
        0.6836684942245483,
        -0.4644167423248291,
        0.3146497905254364,
        -0.2580820620059967,
        -0.43350547552108765,
        -0.11661750078201294,
        0.44940808415412903,
        -0.22344470024108887,
        0.15717263519763947,
        0.3056821823120117,
        -0.004309771582484245,
        0.46316733956336975,
        -0.3226448595523834,
        0.21652677655220032,
        -0.42457354068756104,
        0.515703022480011,
        0.5620718598365784,
        0.531444787979126,
        -0.5783425569534302,
        -0.7386044263839722,
        0.6024349927902222,
        -0.469277024269104,
        -0.9015547633171082,
        -0.8695387840270996,
        -0.8270652294158936,
        0.33999064564704895,
        -0.04938004910945892,
        0.13901475071907043,
        0.722602367401123,
        -0.12134766578674316,
        -0.14046365022659302,
        -0.05101119726896286,
        -0.2307632565498352,
        -0.1811126321554184,
        0.8607655763626099,
        0.3288240432739258,
        -0.5053394436836243,
        -0.5122462511062622,
        0.1192164421081543,
        0.0275164395570755,
        0.05479908734560013,
        0.11381968855857849,
        -0.38611486554145813,
        0.05606910586357117,
        0.08046521246433258
    ]
}