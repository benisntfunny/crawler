{
    "id": "ae3a3f2dbd9fa4d098de391e492464c59bd1d4e402051fb6f9d713273d93c2bd-part2",
    "url": "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2020_spring_sharing_rules.htm&language=en_US&type=5",
    "content": "nullB2B Commerce for Visualforce Release Notes and Upgrade Guide\nTABLE OF CONTENTS\nClose\nClose\nSearch\nSearch\n B2B Commerce for Visualforce Release Notes and Upgrade Guide\n B2B Commerce for Visualforce Winter ’21 (Version 4.13) Release Notes\n B2B Commerce for Visualforce Spring ’20 (Version 4.12) Release Notes\n B2B Commerce for Visualforce Summer ’19 (Version 4.11) Release Notes\n B2B Commerce for Visualforce Spring ’19 (Version 4.10) Release Notes\n B2B Commerce for Visualforce Summer ’18 (Version 4.9) Release Notes\n Upgrade B2B Commerce for Visualforce to a New Release or Patch\n Resolve Guest User Security Alerts to Keep Your Storefronts Secure...\n Install the B2B Commerce for Visualforce Release or Patch for Guest...\n Remove View All Users Permission from Guest User Profiles for B2B...\n Assign Records Created by Guest Users to a Default Owner for B2B...\n Secure Guest Users' Org-Wide Defaults and Sharing Model for B2B...\n Remove Sharing Rules for Carts, Orders, and Addresses\n Maintain Established CloudCraze Solutions\n\nYou are here:\n\nSALESFORCE HELP\nDOCS\nVISUALFORCE B2B COMMERCE RELEASE NOTES AND UPGRADE GUIDE\nRemove Sharing Rules for Carts, Orders, and Addresses\n\nIn some releases, B2B Commerce for Visualforce fixed an issue that potentially exposed personal identifiable information (PII) in carts, orders, and addresses. This issue resulted from the sharing rules that you previously created for CC Cart, CC Contact Address, and CC Order custom objects. This fix removes the dependency on the specific sharing rules. After you install the patch, remove the affected sharing rules and update the sharing attributes in the order confirmation email template.\n\nREQUIRED EDITIONS AND USER PERMISSIONS\nSalesforce CompatibilitySalesforce not available in all orgs) and Lightning Experience for Enterprise, Performance, Unlimited, and Developer editions.\n\n\nB2B Commerce Compatibility\n\nAny solution upgrading to or installing:\n\nB2B Commerce for Visualforce Winter ’21 (version 4.13)\nB2B Commerce for Visualforce Spring ’20 (version 4.12) patch 3.147.8 or later\nB2B Commerce for Visualforce Summer ’19 (version 4.11) patch 3.145.22 or later\nB2B Commerce for Visualforce Spring ’19 (version 4.10) patch 3.142.29 or later\n\n\nUSER PERMISSIONS NEEDED\nTo modify sharing rules:\tManage Sharing\nTo change Visualforce email templates in Salesforce Classic:\tCustomize Application\nDelete the existing sharing rules for the CC Cart, CC Contact Address, and CC Order object.\nIMPORTANT Delete these sharing rules only if you've installed the following releases:\nB2B Commerce for Visualforce Winter ’21 (version 4.13)\nB2B Commerce for Visualforce Spring ’20 (version 4.12) patch 3.147.8 or later\nB2B Commerce for Visualforce Summer ’19 (version 4.11) patch 3.145.22 or later\nB2B Commerce for Visualforce Spring ’19 (version 4.10) patch 3.142.29 or later\n\nThese sharing rules are still required in the following scenarios:\n\nYou’re using any earlier patch release or major version, and you support guest carts and checkout.\nYou’re using the CyberSource for B2B Commerce market template, which still requires the sharing rules for CC Cart and CC Contact Address. The sharing rule for CC Order isn’t required for this market template.\nFrom Setup, enter Sharing Settings in the Quick Find box, and then select Sharing Settings.\nScroll to the CC Cart Sharing Rules section.\nFind the following rule, and click Delete.\nCOLUMN\tVALUE\nCriteria\t\nCC Cart: Owner STARTS WITH 15digitUserID, where 15digitUserID is the 15-digit ID of the user that serves as the default owner of all records created by guest users.\nCC Cart: Owner EQUALS 15or18digitUserID, where 15or18digitUserID is the 15- or 18-digit ID of the user that serves as the default owner of all records created by guest users.\nNOTE If you created the sharing rule programmatically using the Ant Migration Tool, you specified the 15-digit ID. If you created the sharing rule manually, you specified either a 15- or 18-digit ID.\n\nShared With\tStorefront site guest user, such as DefaultStore Site Guest User.\nRepeat these steps for the CC Contact Address and CC Order sharing rules.\nTo ensure that order confirmation emails continue to send after you install the patch, update the CC_Order_Confirm email template with the correct sharing attribute.\nFrom Setup, enter Email Templates in the Quick Find box, and then select Classic Email Templates.\nSelect the CC Order Confirm template.\nClick Edit Template.\nAt the top of the template, add the attribute, renderUsingSystemContextWithoutSharing=\"true\" to the <messaging:emailTemplate> opening tag:\n<messaging:emailTemplate subject=\"Order Confirmation\" recipientType=\"Contact\" relatedToType=\"ccrz__E_Order__c\" renderUsingSystemContextWithoutSharing=\"true\">\nClick Save.\nSEE ALSO\nSecure Guest Users' Org-Wide Defaults and Sharing Model for B2B Commerce for Visualforce\nShow Order Confirmation Details and Send Order Emails\nPREVIOUS\n\nSecure Guest Users' Org-Wide Defaults and Sharing Model for B2B Commerce for Visualforce\n\nDID THIS ARTICLE SOLVE YOUR ISSUE?\nLet us know so we can improve!\nYes\nNo\n ",
    "title": "Removing Legacy Sharing Rules in B2B Commerce for Visualforce",
    "keywords": [
        "Salesforce",
        "Visualforce",
        "Legacy Sharing Rules",
        "Guest Users",
        "Order Confirmation Emails",
        "CC Cart",
        "CC Contact Address",
        "CC Order"
    ],
    "links": [
        "https://help.salesforce.com/sfsites/c/resource/HTCommunityCustomJS/HC_TbidAuth.js",
        "https://help.salesforce.com/s/support\",\"target\":\"_self\",\"label\":\"Contact",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_release_notes.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter_cart.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter_checkout.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter_lwc.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter_trust.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter_admin.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2021_winter_developer.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2020_spring.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2020_spring_plp.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2020_spring_admin.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2020_spring_trust.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2020_spring_patches.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_summer.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_summer_seo.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_summer_trust.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring_upgrade.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring_seo.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring_cart.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring_storefront.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring_performance.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2019_spring_admin.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2018_summer.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2018_summer_plp.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2018_summer_developer.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_rn_2018_summer_patches.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_upgrade.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_upgrade_prepare.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_guest_security.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.cloudcraze_patches.htm&language=en_US&type=5",
        "https://help.salesforce.com/s?language=en_US",
        "https://help.salesforce.com/s/articleView?id=sf.overview_edition_lex_only.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_setup_sharing_rules_metadata.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_guest_security_sharing.htm&language=en_US&type=5",
        "https://help.salesforce.com/s/articleView?id=sf.b2b_commerce_page_checkout_order_confirmation.htm&language=en_US&type=5"
    ],
    "embedding": [
        -0.7202613949775696,
        -1.1123089790344238,
        -0.4958611726760864,
        0.42829734086990356,
        -0.03778058663010597,
        0.41351914405822754,
        0.22016310691833496,
        4.123291969299316,
        1.1335176229476929,
        0.8942304849624634,
        0.2927529215812683,
        0.3623456358909607,
        1.5540181398391724,
        -0.32698148488998413,
        0.08037322759628296,
        0.12957392632961273,
        -0.5608346462249756,
        -0.4278827905654907,
        -0.08111616969108582,
        0.7154887914657593,
        -0.1211254894733429,
        -0.5866824388504028,
        0.10394546389579773,
        -0.7775527834892273,
        -0.1214970201253891,
        0.4836958050727844,
        -0.24894189834594727,
        -0.2891002893447876,
        -0.0023119947873055935,
        -0.3622366786003113,
        1.323382019996643,
        0.29042714834213257,
        0.0792408287525177,
        0.0739060565829277,
        0.06457425653934479,
        -0.4157443940639496,
        -1.0201340913772583,
        0.19313621520996094,
        -0.34290263056755066,
        1.5229727029800415,
        -0.912923276424408,
        -0.6315106153488159,
        0.46084389090538025,
        0.17024782299995422,
        0.103799968957901,
        0.1486813724040985,
        -0.6780742406845093,
        0.4530613422393799,
        0.6524003744125366,
        0.3287661671638489,
        0.04075418412685394,
        0.08037451654672623,
        -0.20513784885406494,
        0.011752739548683167,
        0.4893646538257599,
        0.6675117611885071,
        -0.13718506693840027,
        0.04209855943918228,
        -0.03415059298276901,
        0.6836999654769897,
        -0.2560959756374359,
        -0.015378350391983986,
        0.6666305661201477,
        0.8114631175994873,
        -0.22801773250102997,
        0.5646401047706604,
        0.08846292644739151,
        -0.01254412904381752,
        0.41923215985298157,
        -0.5452711582183838,
        0.0753118097782135,
        -0.3588642179965973,
        -0.36753350496292114,
        0.3337918817996979,
        1.41245436668396,
        0.04574674367904663,
        -1.018599033355713,
        0.12930724024772644,
        -0.3106968402862549,
        -0.264346718788147,
        -0.9732829928398132,
        0.1875014305114746,
        0.34662482142448425,
        -0.150072380900383,
        -0.20845413208007812,
        1.0561516284942627,
        -0.4693659245967865,
        -0.14528340101242065,
        -0.08311258256435394,
        -0.2220599353313446,
        0.06233251094818115,
        0.1722058802843094,
        0.49146634340286255,
        -0.7406703233718872,
        -0.5725144147872925,
        -0.316040575504303,
        0.3434748649597168,
        0.039065051823854446,
        0.05019432306289673,
        -0.529718279838562,
        0.7382650375366211,
        -0.28045761585235596
    ]
}